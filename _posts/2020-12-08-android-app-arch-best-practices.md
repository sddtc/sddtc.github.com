---
title: "[Android Core] æœ€ä½³å®è·µä»€ä¹ˆçš„ å¯å¤ªæœ‰é­…åŠ›äº†"
layout: post
categories: sddtc tech
date: "2020-12-08"
guid: urn:uuid:0dfa4770-99cc-41f1-9cb9-276b067bc41a
tags:
  - Android
---


> Programming is a creative field, and building Android apps isn't an exception.

ğŸ‘ ç¼–ç¨‹æ˜¯ä¸€ä¸ªæå…·åˆ›é€ æ€§çš„é¢†åŸŸï¼Œæ„å»º Android åº”ç”¨ç¨‹åºä¹Ÿä¸ä¾‹å¤–å‘¢ã€‚


## Mobile çš„ç”¨æˆ·ä½“éªŒ
åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ¡Œé¢åº”ç”¨ç¨‹åºéƒ½åªæœ‰ä¸€ä¸ªå•ä¸€çš„å…¥å£ç‚¹æ¥è¿›å…¥æ¡Œé¢åº”ç”¨ç¨‹åºï¼Œè€Œåä½œä¸ºæ•´ä½“çš„è¿›ç¨‹è¿è¡Œã€‚ ç›¸å¯¹è€Œè¨€ Android åº”ç”¨ç¨‹åºè¦å¤æ‚å¾—å¤šã€‚ å…¸å‹çš„ Android åº”ç”¨ç¨‹åºä¼šåŒ…å«å¤šä¸ªåº”ç”¨ç¨‹åºç»„ä»¶ï¼šActivities, Fragments, Services, Content Providers å’Œ Broadcast Receivers æœ‰å…³ä»–ä»¬çš„æ¦‚å¿µè¯·è§[è¿™é‡Œ](https://www.homuralovelive.com/sddtc/2020/12/01/android-core-applications-fundamentals.html)ã€‚

ä½ å¯ä»¥åœ¨åº”ç”¨ç¨‹åºçš„ app manifest ä¸­å£°æ˜è¿™äº›ç»„ä»¶ï¼Œ ä¹‹å Android ç³»ç»Ÿä½¿ç”¨ manifest æ–‡ä»¶æ¥å†³å®šå¦‚ä½•å°†æ‚¨çš„åº”ç”¨ç¨‹åºé›†æˆåˆ°å®‰å“è®¾å¤‡çš„æ•´ä½“ç”¨æˆ·ä½“éªŒä¸­ã€‚ ä¸€ä¸ªèƒ½æ­£å¸¸å·¥ä½œçš„ Android åº”ç”¨ç¨‹åºå¾€å¾€åŒ…å«å¤šä¸ªç»„ä»¶ï¼Œè€Œä¸”ç”¨æˆ·ç»å¸¸åœ¨çŸ­æ—¶é—´å†…ä¸å¤šä¸ªåº”ç”¨ç¨‹åºè¿›è¡Œäº¤äº’ï¼Œå› æ­¤åº”ç”¨ç¨‹åºéœ€è¦é€‚åº”/å¤„ç†ä¸åŒç±»å‹çš„ç”¨æˆ·é©±åŠ¨çš„äº¤äº’è¡Œä¸ºå’Œä»»åŠ¡ã€‚

ä¸¾ä¾‹æ¥è¯´ï¼Œå½“ä½ åœ¨è‡ªå·±å–œæ¬¢çš„ä¸€æ¬¾ç¤¾äº¤ç½‘ç»œåº”ç”¨é‡Œåˆ†äº«ä¸€å¼ ç…§ç‰‡ï¼Œé‚£ä¹ˆéƒ½ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ ï¼šï¼‰

1.  è¯¥åº”ç”¨è¯•å›¾è®¿é—®æ‰‹æœºçš„ç…§ç›¸æœºåŠŸèƒ½ã€‚è¿™æ—¶ï¼ŒAndroid ç³»ç»Ÿä¼šå¯åŠ¨ç›¸æœºåº”ç”¨ç¨‹åºæ¥å¤„ç†è¯¥è¯·æ±‚ã€‚ ä¸æ­¤åŒæ—¶ï¼Œç”¨æˆ·å…¶å®å·²ç»ç¦»å¼€äº†ç¤¾äº¤ç½‘ç»œåº”ç”¨ï¼Œä½†æ˜¯è¿™ç§åˆ‡æ¢ä½“éªŒä»ç„¶æ˜¯æ— ç¼çš„ã€‚
2. ç›¸æœºåº”ç”¨åœ¨è¢«ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ï¼Œç”¨æˆ·å¯èƒ½è¿˜ä¼šè§¦å‘å…¶å®ƒçš„åŠŸèƒ½ï¼Œä¾‹å¦‚å¯åŠ¨æ–‡ä»¶é€‰æ‹©å™¨ï¼Œè¿™å¯èƒ½ä¼šå¯åŠ¨å¦ä¸€ä¸ªåº”ç”¨ï¼ˆæ–‡ä»¶ç®¡ç†åº”ç”¨ï¼‰ã€‚
3. æœ€ç»ˆç…§ç‰‡æ‹æ‘„/ä»ç›¸å†Œä¸­é€‰å–å®Œæ¯•ä¹‹åï¼Œç”¨æˆ·ä¼šè¿”å›åˆ°ç¤¾äº¤ç½‘ç»œåº”ç”¨å¹¶åˆ†äº«å‡ºä¸€å¼ è‡ªå·±æ»¡æ„çš„ç…§ç‰‡ã€‚

åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œç”¨æˆ·éƒ½å¯èƒ½è¢«ç”µè¯æˆ–å„ç§åº”ç”¨çš„é€šçŸ¥æ‰€æ‰“æ‰°ã€‚åœ¨è¿™äº›ä¸­æ–­æ“ä½œåï¼Œç”¨æˆ·ä»å¸Œæœ›èƒ½è¿”å›åˆ°ç¤¾äº¤åº”ç”¨ä¸­å¹¶æ¢å¤åˆ†äº«ç…§ç‰‡çš„ç”¨æˆ·æ—…ç¨‹é‡Œã€‚ æ€»è€Œè¨€ä¹‹ï¼Œè¿™ç§åº”ç”¨ç¨‹åºè·³è·ƒè¡Œä¸ºåœ¨ç§»åŠ¨è®¾å¤‡ä¸Šæ˜¯å¾ˆå¸¸è§çš„ï¼Œå› æ­¤æ‚¨çš„åº”ç”¨ç¨‹åºå¿…é¡»èƒ½å¤Ÿæ­£ç¡®å¤„ç†è¿™äº›æƒ…æ™¯ã€‚  
ç„¶è€Œéœ€è¦è®°ä½çš„æ˜¯ï¼Œç§»åŠ¨è®¾å¤‡ä¹Ÿä¼šå—åˆ°èµ„æºï¼ˆä¾‹å¦‚å†…å­˜ï¼‰çš„é™åˆ¶ï¼Œå› æ­¤æ“ä½œç³»ç»Ÿå¯èƒ½ä¼šéšæ—¶ç»ˆæ­¢æŸäº›åº”ç”¨ç¨‹åºè¿›ç¨‹ï¼Œä»¥ä¾¿ä¸ºæ–°è¿›ç¨‹è…¾å‡ºç©ºé—´ã€‚  
äºæ˜¯åœ¨è¿™ç§ç¯å¢ƒä¸‹ï¼Œæ‚¨çš„åº”ç”¨ç¨‹åºç»„ä»¶å¯èƒ½ä¼šæœ‰ä¸ªåˆ«æ— åºçš„å¯åŠ¨æ–¹å¼ï¼Œè€Œæ“ä½œç³»ç»Ÿæˆ–ç”¨æˆ·å¯ä»¥éšæ—¶é”€æ¯å®ƒä»¬ã€‚ç”±äºè¿™äº›äº‹ä»¶ä¸å—ä½ çš„æ§åˆ¶ï¼Œå› æ­¤ä½ ä¸åº”åœ¨åº”ç”¨ç¨‹åºç»„ä»¶ä¸­å­˜å‚¨ä»»ä½•åº”ç”¨ç¨‹åºçš„æ•°æ®æˆ–çŠ¶æ€ï¼Œå¹¶ä¸”åº”ç”¨ç¨‹åºç»„ä»¶ä¹‹é—´ä¹Ÿä¸åº”è¯¥ç›¸äº’ä¾èµ–ã€‚

## é€šç”¨çš„ä¸¤ä¸ªè®¾è®¡åŸåˆ™
é‚£ä¹ˆä½ ä¹Ÿè®¸ä¼šæœ‰ä¸€ä¸ªç–‘é—® ğŸ¤”ï¸ï¼Œ å¦‚æœä¸åº”è¯¥ä½¿ç”¨åº”ç”¨ç¨‹åºç»„ä»¶æ¥å­˜å‚¨åº”ç”¨ç¨‹åºæ•°æ®å’ŒçŠ¶æ€ï¼Œé‚£ä¹ˆè¯¥å¦‚ä½•è®¾è®¡åº”ç”¨ç¨‹åºï¼Ÿ

### å…³æ³¨ç‚¹åˆ†ç¦»
éµå¾ªçš„æœ€é‡è¦åŸåˆ™æ˜¯å…³æ³¨ç‚¹åˆ†ç¦»([SoC](https://en.wikipedia.org/wiki/Separation_of_concerns))ã€‚  
å°†æ‰€æœ‰ä»£ç éƒ½å®ç°åœ¨ä¸€ä¸ª Activity æˆ– Fragment ä¸­æ˜¯ä¸€ä¸ªå¸¸è§çš„é”™è¯¯ã€‚è¿™äº›åŸºäº UI çš„ç±»åº”ä»…åŒ…å«å¤„ç† UI å’Œæ“ä½œç³»ç»Ÿäº¤äº’çš„é€»è¾‘ã€‚é€šè¿‡ä½¿è¿™äº›ç±»å°½å¯èƒ½ç²¾ç®€ï¼Œå¯ä»¥é¿å…è®¸å¤šä¸ç”Ÿå‘½å‘¨æœŸç›¸å…³çš„é—®é¢˜ã€‚  
âš ï¸è¯·è®°ä½ï¼Œä½ ä¸åº”è¯¥å°è¯•æ‹¥æœ‰ä»»ä½•æœ‰å…³ Activity å’Œ Fragment çš„å®ç°ï¼›ç›¸åçš„ï¼Œä»–ä»¬åªæ˜¯ä¸€äº› Android æ“ä½œç³»ç»Ÿä¸ä½ çš„åº”ç”¨ä¹‹é—´ååŒçš„ç²˜åˆç±»ã€‚æ“ä½œç³»ç»Ÿå¯ä»¥æ ¹æ®ç”¨æˆ·äº¤äº’æˆ–ç”±äºå†…å­˜ä¸è¶³ç­‰ç³»ç»ŸçŠ¶å†µè€Œéšæ—¶é”€æ¯å®ƒä»¬ã€‚ä¸ºäº†æä¾›ä»¤äººæ»¡æ„çš„ç”¨æˆ·ä½“éªŒå’Œæ›´å¯ç®¡ç†çš„åº”ç”¨ç¨‹åºç»´æŠ¤ä½“éªŒï¼Œæœ€å¥½æœ€å¤§ç¨‹åº¦åœ°å‡å°‘å¯¹å®ƒä»¬çš„ä¾èµ–ã€‚

### ä»æ¨¡å‹é©±åŠ¨ UI
å¦ä¸€ä¸ªé‡è¦åŸåˆ™æ˜¯ï¼Œä½ åº”è¯¥ä»æ¨¡å‹ï¼ˆæœ€å¥½æ˜¯æŒä¹…æ€§æ¨¡å‹ï¼‰é©±åŠ¨ UIã€‚æ¨¡å‹æ˜¯è´Ÿè´£å¤„ç†åº”ç”¨ç¨‹åºæ•°æ®çš„ç»„ä»¶ã€‚å®ƒä»¬ç‹¬ç«‹äºåº”ç”¨ç¨‹åºä¸­çš„ View å¯¹è±¡å’Œåº”ç”¨ç¨‹åºç»„ä»¶ï¼Œå› æ­¤ä¸å—åº”ç”¨ç¨‹åºç”Ÿå‘½å‘¨æœŸå’Œç›¸å…³é—®é¢˜çš„å½±å“ã€‚

Persistence æ˜¯ä¸€ä¸ªç†æƒ³çš„çŠ¶æ€ï¼ŒåŸå› å¦‚ä¸‹ï¼š
* å¦‚æœ Android æ“ä½œç³»ç»Ÿé”€æ¯äº†ä½ çš„åº”ç”¨ä»¥é‡Šæ”¾èµ„æºï¼Œä½ çš„ç”¨æˆ·å¹¶ä¸ä¼šä¸¢å¤±æ•°æ®ã€‚
* å¦‚æœç½‘ç»œè¿æ¥ä¸ç¨³å®šæˆ–ä¸å¯ç”¨ï¼Œä½ çš„åº”ç”¨ç¨‹åºä»å°†ç»§ç»­è¿è¡Œã€‚

é€šè¿‡å°†ä½ çš„åº”ç”¨åŸºäºæ¨¡å‹ç±»æ‰¿æ‹…æ˜ç¡®å®šä¹‰çš„æ•°æ®ç®¡ç†èŒè´£ï¼Œä½ çš„åº”ç”¨å°†æ›´å…·å¯æµ‹è¯•æ€§å’Œä¸€è‡´æ€§ã€‚

## æœ€ä½³å®è·µ

### Avoid designating your app's entry pointsâ€”such as activities, services, and broadcast receiversâ€”as sources of data.
> é¿å…å°†åº”ç”¨ç¨‹åºçš„å…¥å£ (Activities, Services å’Œ Broadcast receiver) æŒ‡å®šä¸ºæ•°æ®æº

ç›¸åçš„ï¼Œå®ƒä»¬ä»…åº”ä¸å…¶ä»–ç»„ä»¶åè°ƒå·¥ä½œï¼Œæ¥è·å–ä¸è¯¥ç¨‹åºå…¥å£æ‰€éœ€è¦çš„ç›¸å…³çš„æ•°æ®å­é›†ã€‚ æ¯ä¸ªåº”ç”¨ç¨‹åºç»„ä»¶çš„å¯¿å‘½éƒ½å¾ˆçŸ­ï¼š ä»–ä»¬å–å†³äºç”¨æˆ·çš„æ“ä½œï¼Œå’ŒåŸºäº Android ç³»ç»Ÿçš„å½“å‰çš„è¿è¡Œæƒ…å†µã€‚

### Create well-defined boundaries of responsibility between various modules of your app.
> åœ¨åº”ç”¨ç¨‹åºçš„å„ä¸ªæ¨¡å—ä¹‹é—´åˆ›å»ºæ˜ç¡®å®šä¹‰çš„èŒè´£èŒƒå›´ã€‚

ä¸¾ä¾‹æ¥è®²ï¼Œå°½é‡é¿å…åœ¨ä»£ç ä¸­çš„å¤šä¸ªç±»/åŒ…ä¸­å‡å®šä¹‰ä»ç½‘ç»œè¯·æ±‚ä¸­åŠ è½½æ•°æ®çš„é€»è¾‘ç‰‡æ®µã€‚ åŒæ ·ï¼Œä¸è¦åœ¨åŒä¸€ä¸ªç±»ä¸­å®šä¹‰å¤šä¸ªæ— å…³çš„èŒè´£ï¼Œä¾‹å¦‚æ•°æ®ç¼“å­˜å’Œæ•°æ®ç»‘å®šã€‚

### Expose as little as possible from each module.
> å°½å¯èƒ½å°‘çš„æš´éœ²æ¯ä¸ªæ¨¡å—ã€‚

ä¸è¦è½»æ˜“æš´éœ²ä¸€ä¸ªæ¨¡å—çš„å†…éƒ¨å®ç°ç»†èŠ‚ï¼Œå“ªæ€•ä½ è®¤ä¸ºè‡ªå·±åªä¼šè¿™æ ·åšä¸€æ¬¡/åªæœ‰è¿™ä¸€ä¸ªã€‚ ä½ ç¡®å®å¯èƒ½ä¼šåœ¨çŸ­æœŸå†…è·å¾—ä¸€äº›å¥½å¤„ï¼Œä½†æ˜¯éšç€ä»£ç çš„å‘å±•ï¼Œä½ å°†ä¸å¾—ä¸åŒæ ·æ”¶è·ä¸€äº›æŠ€æœ¯å€ºã€‚

### Consider how to make each module testable in isolation.
> è€ƒè™‘å¦‚ä½•ä½¿æ¯ä¸ªæ¨¡å—ç‹¬ç«‹åœ°å¯æµ‹è¯•ã€‚

ä¸¾ä¾‹æ¥è¯´ï¼Œæ‹¥æœ‰å®šä¹‰æ˜ç¡®çš„å¯ä»ç½‘ç»œè¯·æ±‚ä¸­è·å–æ•°æ®çš„ APIï¼Œå¯ä»¥ä½¿å°†æ•°æ®æŒä¹…åŒ–åœ¨æœ¬åœ°æ•°æ®åº“ä¸­çš„æ¨¡å—çš„æµ‹è¯•å˜å¾—æ›´åŠ è½»æ¾ã€‚ ç›¸åï¼Œå¦‚æœæ‚¨å°†æ¥è‡ªè¿™ä¸¤ä¸ªæ¨¡å—çš„é€»è¾‘æ··åˆå†™åœ¨ä¸€èµ·ï¼Œæˆ–è€…å°†ç½‘ç»œè¯·æ±‚é€»è¾‘ä»£ç åˆ†å¸ƒåœ¨æ•´ä¸ªä»£ç åº“ä¸­ï¼Œåˆ™ä½¿å¾—æµ‹è¯•ä¼šå˜å¾—æ›´åŠ å›°éš¾ï¼Œç”šè‡³ä¸å…·æœ‰å¯æµ‹è¯•æ€§ã€‚

### Focus on the unique core of your app so it stands out from other apps.
> ä¸“æ³¨äºæ‚¨åº”ç”¨ç¨‹åºçš„ç‹¬ç‰¹æ ¸å¿ƒï¼Œä½¿å…¶åœ¨å…¶ä»–åº”ç”¨ç¨‹åºä¸­è„±é¢–è€Œå‡ºã€‚

ä¸è¦ä¸€æ¬¡åˆä¸€æ¬¡åœ°å†™ç›¸åŒçš„æ ·æ¿ä»£ç æ¥é‡æ–°å‘æ˜è½®å­ã€‚ ç›¸åï¼Œå°†æ—¶é—´å’Œç²¾åŠ›é›†ä¸­åœ¨ä½¿æ‚¨çš„åº”ç”¨ä¸ä¼—ä¸åŒçš„æ–¹é¢ï¼Œè®© Android Architecture Components å’Œå…¶ä»–æ¨èçš„åº“æ¥è¾…åŠ©ä½ å¤„ç†åŠŸèƒ½é‡å¤çš„éƒ¨åˆ†ã€‚

### Persist as much relevant and fresh data as possible.
> å°½å¯èƒ½å¤šçš„å±•ç¤ºè¶³å¤Ÿæ–°é²œçš„æ•°æ®ã€‚

å¦‚æœåšæŒè¿™ä¸ªå®è·µï¼Œå³ä½¿ç”¨æˆ·çš„è®¾å¤‡å¤„äºç¦»çº¿æ¨¡å¼ï¼Œç”¨æˆ·ä¹Ÿå¯ä»¥æ­£å¸¸äº«å—ä½ çš„åº”ç”¨ç¨‹åºæ‰€æä¾›çš„åŠŸèƒ½ã€‚ è¯·è®°ä½ï¼Œå¹¶éæ‰€æœ‰ç”¨æˆ·çš„ç½‘ç»œéƒ½æ°¸è¿œæ˜¯ç¨³å®šå¹¶ä¸”å¿«é€Ÿçš„ã€‚

### Assign one data source to be the single source of truth.
> æŒæœ‰ä¸€ä¸ªå•ä¸€æ•°æ®æºï¼Œ åšæŒ single source of truth.

æ¯å½“æ‚¨çš„åº”ç”¨ç¨‹åºéœ€è¦è®¿é—®è¿™äº›æ•°æ®æ—¶ï¼Œå®ƒéƒ½åº”å§‹ç»ˆæºè‡ªè¿™ä¸€å•ä¸€çš„æ•°æ®æºã€‚


æœ¬æ–‡è¯‘è‡ª [jetpack-best-practices](https://developer.android.com/jetpack/guide#best-practices)