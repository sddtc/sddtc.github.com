---
title: å½“ä½ åšæŠ€æœ¯é€‰å‹æ—¶éœ€è¦è€ƒè™‘çš„
date: 2025-06-16
tags: software engineer
---

è½¯ä»¶å·¥ç¨‹æ˜¯æ‰‹æ®µ,ä¸æ˜¯ç›®çš„. ä¸è®ºæ˜¯åšä¼ä¸šè½¯ä»¶å¼€å‘, åšäº§å“éªŒè¯ POC è¿˜æ˜¯ä¸ªäººäº§å“å¼€å‘, ä½ æ€»ä¼šåœ¨ä¸åŒçš„æ—¶åˆ»è€ƒè™‘æŠ€æœ¯æ¡†æ¶, äº¦æˆ–æ˜¯ä¸ç”¨æ¡†æ¶; è€ƒè™‘ä½¿ç”¨æŸä¸ªå·¥å…· A è€Œéå·¥å…· B, ä½¿ç”¨äº‘å¹³å° C è¿˜æ˜¯è¯»å–æ–‡ä»¶ä½¿ç”¨ç¼“å­˜ç­–ç•¥, éƒ½æ˜¯åŸºäºç°é˜¶æ®µ, ä»¥åŠæœªæ¥(çŸ­æœŸ)å¯èƒ½ä¼šå‡ºç°çš„å¯èƒ½æ€§çš„è€ƒè™‘. æ¯•ç«Ÿæœ‰å¥å¾ˆç«çš„è¯
> å…ˆåšä¸€ä¸ªåƒåœ¾å‡ºæ¥

å¹¶ä¸æ˜¯è¯´ä½ åšå‡ºæ¥çš„ä¸œè¥¿æ˜¯â€œåƒåœ¾â€, è€Œæ˜¯è¯´ç®€å•/ç²—ç³™æ˜¯å¼€å§‹çš„å¥½èµ·ç‚¹.

æœ€è¿‘ä½¿ç”¨ `mui+vite+vitest+supabase+vercel` å¿«é€Ÿæ­å»ºäº†ä¸€ä¸ªç«™ç‚¹, å€Ÿæ­¤æ¥è®°å½•ä¸€äº›ç»éªŒ.
é¦–å…ˆç¡®å®šå¼€å‘å·¥å…·, å†™å‰ç«¯é¦–é€‰ `vscode`, å¯¹äº `js` è¯­æ³•é«˜äº®çš„æ”¯æŒå¥½
å…¶æ¬¡é€‰æ‹©å‰ç«¯æ¡†æ¶, æµ‹è¯•æ¡†æ¶, è¿™æ¬¡é€‰æ‹©äº† [vite](https://vite.dev/) + React + [vitest](https://vitest.dev/). ç”¨ `Material UI+React` æ­å»ºäº†ç®€å•çš„é¡µé¢, æœ¬åœ°è°ƒè¯•äº†æ ·å¼ä¸åŠŸèƒ½.
åœ¨é€‰æ‹©äº‘éƒ¨ç½²å¹³å°çš„æ—¶å€™å‚ç…§äº†ç›®å‰ç½‘ç»œä¸Š[æ¨èçš„å…è´¹äº‘å¹³å°](https://gist.github.com/imba-tjd/d73258f0817255dbe77d64d40d985e76), å„æœ‰å„çš„ä¼˜åŠ£, ä¸»è¦è€ƒè™‘çš„æ–¹é¢æœ‰:
1. å…è´¹é¢åº¦: å¦‚æœæ˜¯ POC, é‚£ä¹ˆä½¿ç”¨å…è´¹çš„äº‘å¹³å°æ˜¯ä¸ºäº†é™ä½æˆæœ¬, å¿«é€ŸéªŒè¯
2. åŸŸåæ±¡æŸ“: æŒ‡çš„æ˜¯å¾ˆå¤šå¹³å°ä¼šç»‘å®šå›ºå®šçš„åŸŸå, ä¾‹å¦‚ [vercel](https://vercel.com/home)
3. å®‰å…¨æ€§: å¦‚æœä½ é€‰æ‹©æ˜¯æ— åç«¯æœåŠ¡æˆ–è€…å…¶ä»–BaaS, é‚£ä¹ˆåæœŸè¦è€ƒè™‘æ”¯æŒ `client credentials` æœåŠ¡
4. è¯­è¨€æ”¯æŒ
5. æ˜“ç”¨æ€§

æœ€ç»ˆé€‰æ‹©äº† [vercel](https://vercel.com/home), åˆé€‚çš„å…è´¹é…é¢, å¿«é€Ÿçš„éƒ¨ç½²æµç¨‹, å’Œ `github repo` çš„é›†æˆç®€å•, å†åŠ ä¸Šæœ¬äººæœ‰å¹´åŒ…çš„åŸŸåæœåŠ¡, vercel ä¹Ÿèƒ½æ–¹ä¾¿çš„è¿›è¡Œé…ç½®.
å°†æœ¬åœ°çš„é¡¹ç›®è¿›è¡Œè¿œç«¯éƒ¨ç½²å°±éœ€è¦ä¸€ä¸ªæ„å»ºå·¥å…·, [vite](https://vite.dev/) å¼•èµ·äº†æˆ‘çš„æ³¨æ„, å› ä¸ºåˆå§‹åŒ–é¡¹ç›®æ—¶å¹¶æ²¡æœ‰ä½¿ç”¨ CRA(create-react-appè„šæ‰‹æ¶), æˆ‘å¹¶ä¸æ˜¯ä¸€ä¸ªçƒ­è¡·äºé€šè¿‡ç®€å•çš„å´æœªçŸ¥çš„å‘½ä»¤æ¥å¯åŠ¨é¡¹ç›®çš„äºº, å› ä¸ºä¸°å¯Œçš„ä¾èµ–å’Œé…ç½®è®©æˆ‘å¹¶ä¸èƒ½ç«‹åˆ»æ„è¯†åˆ°å®ƒä»¬éƒ½æ˜¯åšä»€ä¹ˆçš„, ä¹Ÿè®©æœ¬èº«ç®€å•çš„äº‹æƒ…å¤æ‚åŒ–. æ¯•ç«Ÿæ–°å¢å®¹æ˜“, ä½†æ˜¯åˆ é™¤çš„æˆæœ¬æ˜¯å·¨å¤§çš„. åœ¨æ²¡æœ‰ææ¸…æ¥šä¹‹å‰, ä¸ºä»€ä¹ˆè¦åŸ‹ä¸‹ä¸€é¢—å°å°çš„ç‚¸å¼¹å‘¢ğŸ˜„, btw: ä»Šå¹´2æœˆ14æ—¥çš„æ–‡ç« [Sunsetting Create React App](https://react.dev/blog/2025/02/14/sunsetting-create-react-app)ä¹Ÿæ„å‘³ç€ CRA ä¸å†è¢«å®˜æ–¹æ¨èä½¿ç”¨.
ç›®å‰ vite.config.js çš„å†…å®¹ä»…æœ‰:

```js
import { defineConfig } from 'vite'
import { configDefaults } from 'vitest/config'
import react from '@vitejs/plugin-react'

export default defineConfig({
  plugins: [react()],
  test: {
    globals: true,
    environment: 'jsdom',
    setupFiles: ['./vitest-setup.js'],
    coverage: {
      reporter: ['text', 'json', 'html'],
      exclude: [
        ...configDefaults.exclude,
        'src/index.jsx'
      ]
    }
  }
})
```
å…¶ä¸­ `globals: true` æ˜¯ä¸ºäº†è§£å†³è·‘ä¸€ä¸ªæµ‹è¯•æ–‡ä»¶çš„å¤šä¸ªå•å…ƒæµ‹è¯•æ—¶, é¿å… `render` é‡å¤çš„å…ƒç´ , ä¿è¯æ¯æ¬¡çš„ dom æŒ‚è½½æ—¶å…¨å±€æ—¶æ˜¯è¢«å…¶å®ƒå•æµ‹å¯è§çš„. `environment: 'jsdom'` å’Œ `'./vitest-setup.js'` æ˜¯ä¸ºäº† components æµ‹è¯•æ¨¡æ‹ŸçœŸå®çš„æµè§ˆå™¨html domæ ‘. é¡¹ç›®åœ¨æœ¬åœ°è·‘å•æµ‹æ—¶, è€Œéç”¨æˆ·çœŸå®çš„ä½¿ç”¨åœºæ™¯(æµè§ˆå™¨å†…éƒ¨), è€Œæ˜¯åœ¨ js çš„è¿è¡Œæ—¶ç¯å¢ƒ(node), äºæ˜¯ä½¿ç”¨ `jsdom` æ˜¯ä¸ºäº†ä¿è¯ç»„ä»¶çš„æ¸²æŸ“å’Œè¡Œä¸ºèƒ½å¤Ÿæ¨¡æ‹Ÿç”¨æˆ·çš„ä½¿ç”¨åœºæ™¯. è§[testing-library: add vitest-setup.js](https://testing-library.com/docs/svelte-testing-library/setup/#vitest).
æœ€å `coverage` çš„é…ç½®æ˜¯ä¸ºäº†ç†ç›´æ°”å£®çš„ä¸ä¸º `src/index.jsx` å†™æµ‹è¯•ğŸ˜‰.
[supabase](https://supabase.com/) æ˜¯ä¼—å¤šå…è´¹å¼€æºæ•°æ®åº“å¹³å°, é€šè¿‡jwt token(client level, service level) æ¥æä¾›è¯»å†™æœåŠ¡, å…¶ä¸­å¯ä»¥é…ç½® row level policy æ¥ä¿è¯ç”¨æˆ·å¯¹äºæ•°æ®çš„æƒé™éªŒè¯. é€‰æ‹©å®ƒä¹Ÿæ˜¯å› ä¸ºå®ƒçš„ä½¿ç”¨æ€§ç®€å•, ä½†æ˜¯è®¿é—®é€Ÿåº¦åœ¨æ­¤æ‰“å‡ºä¸€ä¸ªå°é—®å·å§.

åœ¨è€ƒè™‘æµ‹è¯•æ¡†æ¶å’Œæµ‹è¯•é‡‘å­—å¡”æ—¶é€‰æ‹© `vitest` + (ç»„ä»¶å•æµ‹+ä¸šåŠ¡é€»è¾‘å•æµ‹)+é¡µé¢é›†æˆæµ‹è¯•+UIæµ‹è¯•.
å…¶ä¸­ `vitest` åŸºæœ¬ä¸Šå¯ä»¥å¹³æ›¿ `jest`: æä¾› `describe, it, expect, vi, beforeEach` ç­‰æ–¹æ³•. å…¶ä¸­åœ¨ `mock` çš„ä½¿ç”¨ä¸Šæœ‰å°å°å·®åˆ«. ä¾‹å¦‚ `vitest` éœ€è¦ä½¿ç”¨ `vi.hoisted` æ–¹æ³•æ¥è¿›è¡Œ mock å‡½æ•°çš„å£°æ˜.
è€Œåœ¨æµ‹è¯• react ç»„ä»¶æ—¶ä¾ç„¶ä½¿ç”¨ `@testing-library/react` çš„ `render, screen, fireEvent` ç­‰æ–¹æ³•.
å†™ä¸‹è¿™äº›çš„æ—¶å€™çªç„¶æƒ³èµ·ä¹‹å‰ä¸ºä¸€ä¸ªäº§å“è®¾è®¡æµ‹è¯•é‡‘å­—å¡”, å…¶å®æœ€éš¾çš„å¹¶ä¸æ˜¯è®¾è®¡, è€Œæ˜¯è®©ä»–äººç†è§£, åœ¨å¤§å®¶æèµ· â€œä¸ºä»€ä¹ˆè¦å†™æµ‹è¯•â€, â€œå¦‚æœå†™äº† xx æ˜¯ä¸æ˜¯å°±ä¸ç”¨å†™ yy", "zz è¿™ä¹ˆéš¾å†™æœ‰ä»€ä¹ˆæ„ä¹‰" ä¹‹ç±»çš„å›°æƒ‘. æˆ‘æƒ³, é¦–å…ˆæµ‹è¯•çš„ç¼–å†™æ˜¯ç”¨è‡ªåŠ¨åŒ–çš„ç¨‹åºç®€åŒ–äººå·¥éªŒè¯çš„ç¹ç, å…¶æ¬¡ç¼–å†™æµ‹è¯•ç¨‹åºæ˜¯ä¿ƒä½¿å¼€å‘äººå‘˜åˆ‡æ¢äº§å“çš„è§’åº¦æ€è€ƒé—®é¢˜; æœ€åå¯¹äºæµ‹è¯•ç±»å‹çš„æŠ‰æ‹©å’Œåˆ å‡çš„è®¨è®º, æˆ‘æƒ³è¯´, å¦‚æœæµ‹è¯•èƒ½è§£å†³é—®é¢˜, å­˜åœ¨å°±æ˜¯åˆç†çš„.

æœ€åçš„æœ€åå†é…ç½®ä¸‹è‡ªå·±çš„ eslint, ä¸€æ•´ä¸ªé¡¹ç›®å°±å®Œå¤‡äº† ğŸ‰
ä»¥ä¸Š.

æ–‡åè¯:
æŒ‚è½½VPNæ—¶ docker ä¸‹è½½é•œåƒä¸€ç›´æŠ¥é”™
> Error response from daemon: Get "https://registry-1.docker.io/v2/": context deadline exceeded (Client.Timeout exceeded while awaiting headers)

æœ¬æœºä½¿ç”¨ colima å¯åŠ¨ docker, æŸ¥äº†åŠå¤©ä¹Ÿæ²¡æ‰¾åˆ°è§£å†³æ–¹æ¡ˆ, æ”¾å¼ƒä½¿ç”¨ colima, ä¸‹è½½ docker desktop è§£å†³äº†é—®é¢˜. çœŸæ˜¯æŸ³æš—èŠ±æ˜åˆä¸€æ‘ ğŸ˜
